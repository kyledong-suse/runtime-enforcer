apiVersion: apps/v1
kind: Deployment
metadata:
  name: ubuntu-deployment
  namespace: default
  labels:
    app: ubuntu-deployment
spec:
  replicas: 1
  selector:
    matchLabels:
      app: ubuntu
      type: deployment
  template:
    metadata:
      labels:
        app: ubuntu
        type: deployment
        security.rancher.io/policy: test-policy
    spec:
      containers:
      - name: ubuntu
        image: ubuntu
        # We create a while loop to continually run sleep and ls.
        # This way we can detect two groups of processes in our test:
        # - process snapshot (bash)
        # - process events (sleep and ls).
        command: ["bash", "-c", "while true; do sleep 5; ls; done"]
