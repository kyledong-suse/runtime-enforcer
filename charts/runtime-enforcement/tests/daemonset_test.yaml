suite: "Daemon DaemonSet Tests"
templates:
  - "templates/daemon/daemonset.yaml"

tests:
  - it: "should allow image, and imagePullPolicy to be overridden"
    set:
      daemon:
        daemon:
          image:
            repository: somewhere/daemon
            tag: v9.9.9
            pullPolicy: Always
    asserts:
      - equal:
          path: "spec.template.spec.containers[0].image"
          value: "somewhere/daemon:v9.9.9"
      - equal:
          path: "spec.template.spec.containers[0].imagePullPolicy"
          value: "Always"

  - it: "should include --enable-learning flag when learning is enabled"
    set:
      learning:
        enabled: true
    asserts:
      - contains:
          path: "spec.template.spec.containers[0].args"
          content: "--enable-learning"

  - it: "should not include --enable-learning flag when learning is disabled"
    set:
      learning:
        enabled: false
    asserts:
      - notContains:
          path: "spec.template.spec.containers[0].args"
          content: "--enable-learning"
